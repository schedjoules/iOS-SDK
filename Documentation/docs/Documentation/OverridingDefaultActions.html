<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="html/html; charset=utf-8" />
		<title>OverridingDefaultActions Document</title>
		<meta id="xcode-display" name="xcode-display" content="render"/>
		<link rel="stylesheet" type="text/css" href="../../css/styles.css" media="all" />
		<link rel="stylesheet" type="text/css" media="print" href="../../css/stylesPrint.css" />
		<meta name="generator" content="appledoc 2.2 (build 963)" />
	</head>
	<body>
		<header id="top_header">
			<div id="library" class="hideInXcode">
				<h1><a id="libraryTitle" href="../../index.html">CalendarStore </a></h1>
				<a id="developerHome" href="../../index.html">SchedJoules</a>
			</div>
			
			<div id="title" role="banner">
				<h1 class="hideInXcode" id="pageTitleHeader">OverridingDefaultActions Document</h1>
			</div>
			<ul id="headerButtons" role="toolbar"></ul>
		</header>
		<article>
			<a title="OverridingDefaultActions Document" name="top"></a>
			<div id="overview_contents" role="main">
				<div id="container">	
					<h1>Overriding Default Actions</h1>

<h2>Overview</h2>

<p>The CalendarStore framework provides UI classes and low-level model classes. The UI classes provide a rich and complete store experience to the user, while the model classes allows apps to build their own UI.</p>

<p>However, often apps only want to change some small part of the UI. It wouldn&rsquo;t make much sense to re-implement the whole UI from scratch to accomplish that. For that, all UI classes implement the <code>pageItemHandlerDelegate</code>, to allow apps to override specific behavior only.</p>

<h2>Default PageItem actions</h2>

<p>The UI classes (<a href="../../Classes/CalStoreCalendarStoreViewController.html">CalStoreCalendarStoreViewController</a>, <a href="../../Classes/CalStoreStyledPageViewController.html">CalStoreStyledPageViewController</a>, etc) all perform specific actions when the user interact when a <a href="../../Classes/CalStorePageItem.html">CalStorePageItem</a> object via their UI.</p>

<p>For example, CalStoreCalendarViewController will start installing a calendar via EventKit when the user taps on an already purchases item. <a href="../../Classes/CalStoreStyledPageViewController.html">CalStoreStyledPageViewController</a> does the same, only presenting different UI.</p>

<h2>Overriding PageItem actions</h2>

<p>Every UI class that interacts with CalStorePageItem&rsquo;s, does have a <code>pageItemHandlerDelegate</code>. Delegates should conform to the formal protocol <a href="../../Protocols/CalStorePageItemHandlerDelegate.html">CalStorePageItemHandlerDelegate</a>. This delegate object will receive various callbacks when a user interacts with a page-item and allows the delegate to override and stop the default behavior of the action, dynamically by returning <code>NO</code> for the should* methods. Returning <code>YES</code> or not implementing it, will ensure the default action will be performed.</p>

<h2>Example: Overriding installation behavior</h2>

<p>If you have an app that doesn&rsquo;t want to use EventKit for installing calendars, you can still use  the provided UI classes and override the installation process.  The following sample code will show how to accomplish this:</p>

<pre><code>@class SomeViewController () CalStorePageItemHandlerDelegate
@end

@implementation SomeViewController

-(void)launchCalendarStore
{
    CalStoreCalendarViewController* vc = [CalStoreCalendarStoreViewController calendarStoreViewController];
    vc.pageItemHandlerDelegate = self;
    [self presentViewController:vc animated:YES completion:nil];
}

-(BOOL)shouldInstallCalendarForItem:(CalStorePageItemCalendar*)pageItem
                       withCallback:(CalStorePageItemHandlerDelegateCallback)showViewControllerCallback
{
    // NOTE: in general, it's a good idea to provide some 'progress' feedback UI
    // to the user, either with the help of showViewControllerCallback() our other means.

    // let the framework create a unique url for our subscription
    [pageItem createUrlWithCompletionHandler:^(NSURL* url, NSError* error){

        // if we got an url, let our internal engine subscribe to the calendar
        if[(url != nil)
           [[OurInternalICSEngine sharedEngine] addSubscribedCalendarWithUrl:url];
        else
            NSLog(@"Error when requesting url for pageItem (%@): %@", pageItem, url); // we should also show the error to the user
    }];


    // we override this behavior, so return NO to indicate the default behavior should not be performed
    return NO;
}

@end
</code></pre>

<h2>Presenting Custom ViewControllers</h2>

<p>Each method of the <a href="../../Protocols/CalStorePageItemHandlerDelegate.html">CalStorePageItemHandlerDelegate</a> protocol has a showViewControllerCallback parameter. This parameter is a block that takes one UIViewController* object. If you want to show a custom view controller for some action, you should call this block with your view controller as parameter: <code>presentViewController(vc)</code>.</p>

<p>Be aware that, one calling showViewControllerCallback, the delegate method <code>shouldShowViewController:forItem:withCallback:</code> won&rsquo;t be invoked; it will only be invoked by default actions, not overriden behavior.</p>

<p>The following sample code will show how to let the UI classes show custom view controllers.</p>

<pre><code>@class SomeViewController () CalStorePageItemHandlerDelegate
@end

@implementation SomeViewController

-(void)launchCalendarStore
{
    CalStoreCalendarViewController* vc = [CalStoreCalendarStoreViewController calendarStoreViewController];
    vc.pageItemHandlerDelegate = self;
    [self presentViewController:vc animated:YES completion:nil];
}

-(BOOL)shouldNavigateToWeatherForItem:(CalStorePageItemParameterizedCalendar*)pageItem
                         withCallback:(CalStorePageItemHandlerDelegateCallback)showViewControllerCallback;
{
    // create our custom weather view controller
    MyCustomWeatherViewController* vc = [[MyCustomWeatherViewController alloc] init];
    vc.pageItem = pageItem;

    // let the UI class present/push it
    showViewControllerCallback(vc);

    // we override this behavior, so return NO to indicate the default behavior should not be performed
    return NO;
}

@end
</code></pre>
				</div>
				<div id="footer">
					<hr />
					<div class="footer-copyright">
						<p><span class="copyright">&copy; 2014 SchedJoules. All rights reserved. (Last updated: 2014-11-19)</span><br />
						
						<span class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2 (build 963)</a>.</span></p>
						
					
					</div>
				</div>
			</div>
		</article>
	</body>
</html>